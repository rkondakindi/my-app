# MyApp Infrastructure

Configuration in this directory creates the following AWS Resources
- Auto Scaling Group
- Elastic Load Balancer
- Health Check

## Usage

Create `terraform.tfvars` file to provide vaules to variables. Here find the reference file below. data But, Make sure to change VPC, subnets, your_source_ip details as per your AWS settings. 

```
stack_name              = "mystack"
application_health_path = "/"
application_port        = 8080
autoscale_group_name    = "myapp-asg"
launch_config_name      = "myapp-lc"
lb_name                 = "myapp-alb"
environment             = "test"
image_id                = "ami-07079058aa890ee37"
instance_type           = "t2.large"
keypair_name            = "rtest"
vpc_id                  = "vpc-5b2f00b3b"
subnets                 = ["subnet-xxxxx","subnet-yyyyyyy"]
volume_size             = 30
volume_type             = "gp2"
your_source_ip          = "42.8.8.8/32"
``` 
you need to execute below to deploy your application

```bash
$ terraform init
$ terraform plan
$ terraform apply
```
Successful Terraform deploy display outputs and click on url_name value to access page.

Note that this example may create resources which can cost money. Run `terraform destroy` when you don't need these resources.

## Inputs

Here find the sample inputs required to deploy MyApp Infrastructure

| Name | Description |
|------|-------------|
| stack_name | Name of the entire stack name |
| environment | Name of the environment. AlloweValues: prod/stage/uat/test/dev |
| vpc_id | Enter your VPC ID. eg: vpc-xxxxxx |
| image_id | The AWS AMI to launch|
| instance_type | The size of instance to launch |
| keypair_name | The SSH keypair name that should be used to connect to EC2 instance |
| volume_size | The size of the volume in gigabytes |
| volume_type | The type of volume. Can be standard, gp2, or io1. (Default: standard) |
| subnets | A list of subnet IDs to launch resources in AWS  |
| application_health_path | Enter your application path for ELB Health Checks. eg: /, /app/health, /login |
| application_port | Enter port of the application will be running under ASG |
| autoscale_group_name | The name of the auto scaling group. By default generated by Terraform |
| launch_config_name | The  Prefix name of the launch configuration. Creates a unique name beginning with the specified prefix |
| lb_name | Name of the Load Balancer |
| your_source_ip | Source IP to get access to Appliation. Enter your public-IP if default VPC used. Eg: 44.32.45.67/32 |


## Outputs

| Name | Description |
|------|-------------|
| asg_sg_name | Security Group Name of the AutoScaling group |
| alb_sg_name | Security Group Name of the Elastic Load Balancer |
| asg_lc_name | AutoScaling Launch Configuration Name |
| asg_id | AutoScaling ID |
| elb_arn | Elastic Load Balancer ID |
| url_name | Application URL with ELB DNS Name |
| elb_zone_id | Zone ID of the Elastic Load Balancer |

